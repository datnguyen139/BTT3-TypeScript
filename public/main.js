/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
var __webpack_exports__ = {};
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/

const newTask = document.querySelector(".newtask");
const newList = document.querySelector(".middle");
const footer = document.querySelector(".bottom");
const selectAll = document.querySelector("#select");
const itemLeft = document.querySelector("strong");
const clearcomplete = document.querySelector(".clearcompleted");
const active = document.querySelector("#active");
const all = document.querySelector("#all");
const completed = document.querySelector("#completed");
window.DeleteTask = function (id) {
    return DeleteTask(id);
};
window.CheckComplete = function (selectask) {
    return CheckComplete(selectask);
};
window.editTask = function (event) {
    return editTask(event);
};
;
let todos;
todos = JSON.parse((localStorage.getItem("listTodo") || '[]'));
active.addEventListener('click', function () {
    ShowListTask("active");
    active.classList.add("active");
    all.classList.remove("active");
    completed.classList.remove("active");
});
all.addEventListener('click', function () {
    ShowListTask("all");
    active.classList.remove("active");
    all.classList.add("active");
    completed.classList.remove("active");
});
completed.addEventListener('click', function () {
    ShowListTask("completed");
    active.classList.remove("active");
    all.classList.remove("active");
    completed.classList.add("active");
});
clearcomplete.addEventListener('click', function () {
    let newtodos = todos.reduce((newtodos, data) => (data.complete !== "completed" && newtodos.push(data), newtodos), []);
    todos = newtodos;
    localStorage.setItem("listTodo", JSON.stringify(todos));
    ShowListTask("all");
});
selectAll.addEventListener('click', function () {
    if (selectAll.className === "select") {
        todos.forEach(data => {
            data.complete = "completed";
        });
        selectAll.className = "selectall";
    }
    else {
        todos.forEach(data => {
            data.complete = "active";
        });
        selectAll.className = "select";
    }
    localStorage.setItem("listTodo", JSON.stringify(todos));
    ShowListTask("all");
});
function countTaskActive() {
    let countTaskActive = todos.length;
    let countTaskCompleted = 0;
    todos.forEach(data => {
        if (data.complete === "completed") {
            countTaskActive -= 1;
            countTaskCompleted += 1;
        }
    });
    itemLeft.innerHTML = `${countTaskActive}`;
    if (countTaskActive === 0 && countTaskCompleted === 0) {
        footer.setAttribute("style", "display: none");
        selectAll.setAttribute("style", "display: none");
    }
    else {
        footer.removeAttribute("style");
        selectAll.removeAttribute("style");
    }
}
function editTask(event) {
    let edit_task = event.parentElement.firstElementChild;
    console.log(edit_task);
    edit_task.removeAttribute("readonly");
    edit_task.addEventListener('mouseout', function () {
        edit_task.setAttribute("readonly", "readonly");
        localStorage.setItem("listTodo", JSON.stringify(todos));
    });
}
function CheckComplete(selectask) {
    let check = selectask.parentElement.firstElementChild;
    let index = parseInt(check.id);
    if (selectask.checked) {
        check.classList.add("checked");
        todos[index].complete = "completed";
        countTaskActive();
    }
    else {
        check.classList.remove("checked");
        todos[index].complete = "active";
        countTaskActive();
    }
    if (completed.classList.contains("active") === true)
        ShowListTask("completed");
    else if (active.classList.contains("active") === true) {
        ShowListTask("active");
    }
    else {
        ShowListTask("all");
    }
    localStorage.setItem("listTodo", JSON.stringify(todos));
}
function DeleteTask(id) {
    todos.splice(id, 1);
    localStorage.setItem("listTodo", JSON.stringify(todos));
    if (completed.classList.contains("active") === true)
        ShowListTask("completed");
    else if (active.classList.contains("active") === true) {
        ShowListTask("active");
    }
    else {
        ShowListTask("all");
    }
    countTaskActive();
}
function ShowListTask(event) {
    let html = "";
    if (todos) {
        todos.forEach((data, id) => {
            let ischeck = data.complete;
            if (ischeck === "completed") {
                ischeck = "checked";
            }
            else {
                ischeck = "";
            }
            if (event === data.complete || event === "all") {
                html += `
      <div class="to-do">
        <input type="text" class="text ${ischeck}" id = "${id}" value = "${data.task}" ondblclick = "editTask(this)" readonly>
        <input type="checkbox" class="checkbox" id = "${id}" onclick = "CheckComplete(this)" ${ischeck}>
        <button class="delete" id="${id}" onclick = "DeleteTask(${id})"><i class="fa-solid fa-xmark"></i></button>
      </div>`;
            }
        });
        newList.innerHTML = html;
        countTaskActive();
    }
}
ShowListTask("all");
newTask.addEventListener('keyup', function (event) {
    let inputValue = newTask.value.trim();
    if (event.key == "Enter" && inputValue == "") {
        alert("please fill in task input");
    }
    else if (event.key === "Enter" && inputValue !== "") {
        if (!todos) {
            todos = [];
        }
        let obj = {
            task: inputValue,
            complete: "active"
        };
        todos.push(obj);
        localStorage.setItem("listTodo", JSON.stringify(todos));
        newTask.value = "";
        ShowListTask("all");
        countTaskActive();
    }
});

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9idHQzLy4vc3JjL21haW4udHMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbmV3VGFzayA9ICg8SFRNTElucHV0RWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm5ld3Rhc2tcIikpXG5jb25zdCBuZXdMaXN0ID0gKDxIVE1MRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1pZGRsZVwiKSlcbmNvbnN0IGZvb3RlciA9ICg8SFRNTEVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ib3R0b21cIikpXG5jb25zdCBzZWxlY3RBbGwgPSAoPEhUTUxCdXR0b25FbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2VsZWN0XCIpKVxuY29uc3QgaXRlbUxlZnQgPSAoPEhUTUxFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJzdHJvbmdcIikpXG5jb25zdCBjbGVhcmNvbXBsZXRlID0gKDxIVE1MQnV0dG9uRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsZWFyY29tcGxldGVkXCIpKVxuY29uc3QgYWN0aXZlID0gKDxIVE1MQW5jaG9yRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FjdGl2ZVwiKSlcbmNvbnN0IGFsbCA9ICg8SFRNTEFuY2hvckVsZW1lbnQ+ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhbGxcIikpXG5jb25zdCBjb21wbGV0ZWQgPSAoPEhUTUxBbmNob3JFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY29tcGxldGVkXCIpKVxuXG53aW5kb3cuRGVsZXRlVGFzayA9IGZ1bmN0aW9uKGlkOiBudW1iZXIpe1xuICByZXR1cm4gRGVsZXRlVGFzayhpZCk7XG59XG53aW5kb3cuQ2hlY2tDb21wbGV0ZSA9IGZ1bmN0aW9uKHNlbGVjdGFzazogSFRNTElucHV0RWxlbWVudCl7XG4gIHJldHVybiBDaGVja0NvbXBsZXRlKHNlbGVjdGFzaylcbn1cbndpbmRvdy5lZGl0VGFzayA9IGZ1bmN0aW9uKGV2ZW50OiBIVE1MSW5wdXRFbGVtZW50KXtcbiAgcmV0dXJuIGVkaXRUYXNrKGV2ZW50KVxufVxuXG5pbnRlcmZhY2UgTGlzdFRvZG8ge1xuICB0YXNrOiBzdHJpbmdcbiAgY29tcGxldGU6IHN0cmluZ1xufTtcblxubGV0IHRvZG9zOiBMaXN0VG9kb1tdO1xudG9kb3MgPSBKU09OLnBhcnNlKChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxpc3RUb2RvXCIpfHwnW10nKSk7XG5cbmFjdGl2ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICBTaG93TGlzdFRhc2soXCJhY3RpdmVcIilcbiAgYWN0aXZlLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIilcbiAgYWxsLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbiAgY29tcGxldGVkLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbn0pXG5cbmFsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICBTaG93TGlzdFRhc2soXCJhbGxcIilcbiAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbiAgYWxsLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIilcbiAgY29tcGxldGVkLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbn0pXG5cbmNvbXBsZXRlZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICBTaG93TGlzdFRhc2soXCJjb21wbGV0ZWRcIilcbiAgYWN0aXZlLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbiAgYWxsLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIilcbiAgY29tcGxldGVkLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIilcbn0pXG5cblxuY2xlYXJjb21wbGV0ZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKSB7XG4gIGxldCBuZXd0b2RvcyA9IHRvZG9zLnJlZHVjZSgobmV3dG9kb3MsIGRhdGEpID0+IChkYXRhLmNvbXBsZXRlICE9PSBcImNvbXBsZXRlZFwiICYmIG5ld3RvZG9zLnB1c2goZGF0YSksbmV3dG9kb3MpLFtdKVxuICB0b2RvcyA9IG5ld3RvZG9zXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwibGlzdFRvZG9cIixKU09OLnN0cmluZ2lmeSh0b2RvcykpXG4gIFNob3dMaXN0VGFzayhcImFsbFwiKVxufSlcblxuc2VsZWN0QWxsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpIHtcbiAgaWYoc2VsZWN0QWxsLmNsYXNzTmFtZSA9PT0gXCJzZWxlY3RcIiApIHtcbiAgICB0b2Rvcy5mb3JFYWNoKGRhdGEgPT57XG4gICAgICBkYXRhLmNvbXBsZXRlID0gXCJjb21wbGV0ZWRcIlxuICAgIH0pXG4gICAgc2VsZWN0QWxsLmNsYXNzTmFtZSA9IFwic2VsZWN0YWxsXCJcbiAgfSBlbHNlIHtcbiAgICB0b2Rvcy5mb3JFYWNoKGRhdGEgPT57XG4gICAgICBkYXRhLmNvbXBsZXRlID0gXCJhY3RpdmVcIlxuICAgIH0pXG4gICAgc2VsZWN0QWxsLmNsYXNzTmFtZSA9IFwic2VsZWN0XCJcbiAgfVxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxpc3RUb2RvXCIsSlNPTi5zdHJpbmdpZnkodG9kb3MpKVxuICBTaG93TGlzdFRhc2soXCJhbGxcIilcbn0pXG5cbmZ1bmN0aW9uIGNvdW50VGFza0FjdGl2ZSgpIHtcbiAgbGV0IGNvdW50VGFza0FjdGl2ZSA9IHRvZG9zLmxlbmd0aFxuICBsZXQgY291bnRUYXNrQ29tcGxldGVkID0gMFxuICB0b2Rvcy5mb3JFYWNoKGRhdGEgPT4ge1xuICAgICAgaWYgKGRhdGEuY29tcGxldGUgPT09IFwiY29tcGxldGVkXCIpIHtcbiAgICAgICAgICBjb3VudFRhc2tBY3RpdmUgLT0gMVxuICAgICAgICAgIGNvdW50VGFza0NvbXBsZXRlZCArPSAxXG4gICAgICB9XG4gIH0pXG4gIGl0ZW1MZWZ0LmlubmVySFRNTCA9IGAke2NvdW50VGFza0FjdGl2ZX1gXG4gIGlmIChjb3VudFRhc2tBY3RpdmUgPT09IDAgJiYgY291bnRUYXNrQ29tcGxldGVkID09PSAwKSB7XG4gICAgICBmb290ZXIuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lXCIpXG4gICAgICBzZWxlY3RBbGwuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJkaXNwbGF5OiBub25lXCIpXG4gIH0gZWxzZSB7XG4gICAgICBmb290ZXIucmVtb3ZlQXR0cmlidXRlKFwic3R5bGVcIilcbiAgICAgIHNlbGVjdEFsbC5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKVxuICB9XG59XG5cbmZ1bmN0aW9uIGVkaXRUYXNrKGV2ZW50OiBIVE1MSW5wdXRFbGVtZW50KSB7XG4gIGxldCBlZGl0X3Rhc2sgPSBldmVudC5wYXJlbnRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkXG4gIGNvbnNvbGUubG9nKGVkaXRfdGFzaylcbiAgZWRpdF90YXNrLnJlbW92ZUF0dHJpYnV0ZShcInJlYWRvbmx5XCIpXG4gIGVkaXRfdGFzay5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCkge1xuICAgICAgZWRpdF90YXNrLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsIFwicmVhZG9ubHlcIilcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwibGlzdFRvZG9cIiwgSlNPTi5zdHJpbmdpZnkodG9kb3MpKVxuICB9KVxufVxuXG5mdW5jdGlvbiBDaGVja0NvbXBsZXRlKHNlbGVjdGFzazogSFRNTElucHV0RWxlbWVudCkge1xuICBsZXQgY2hlY2sgPSBzZWxlY3Rhc2sucGFyZW50RWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZDtcbiAgbGV0IGluZGV4OiBudW1iZXIgPSBwYXJzZUludChjaGVjay5pZClcbiAgaWYoc2VsZWN0YXNrLmNoZWNrZWQpIHtcbiAgICBjaGVjay5jbGFzc0xpc3QuYWRkKFwiY2hlY2tlZFwiKTtcbiAgICB0b2Rvc1tpbmRleF0uY29tcGxldGUgPSBcImNvbXBsZXRlZFwiO1xuICAgIGNvdW50VGFza0FjdGl2ZSgpXG4gIH0gZWxzZSB7XG4gICAgY2hlY2suY2xhc3NMaXN0LnJlbW92ZShcImNoZWNrZWRcIik7XG4gICAgdG9kb3NbaW5kZXhdLmNvbXBsZXRlID0gXCJhY3RpdmVcIjtcbiAgICBjb3VudFRhc2tBY3RpdmUoKVxuICB9XG4gIGlmKGNvbXBsZXRlZC5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmVcIikgPT09IHRydWUpXG4gICAgU2hvd0xpc3RUYXNrKFwiY29tcGxldGVkXCIpXG4gIGVsc2UgaWYoYWN0aXZlLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSA9PT0gdHJ1ZSkge1xuICAgIFNob3dMaXN0VGFzayhcImFjdGl2ZVwiKVxuICB9IGVsc2Uge1xuICAgIFNob3dMaXN0VGFzayhcImFsbFwiKVxuICB9XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwibGlzdFRvZG9cIixKU09OLnN0cmluZ2lmeSh0b2RvcykpXG59XG5cbmZ1bmN0aW9uIERlbGV0ZVRhc2soaWQ6IG51bWJlcil7XG4gIHRvZG9zLnNwbGljZShpZCwxKVxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImxpc3RUb2RvXCIsIEpTT04uc3RyaW5naWZ5KHRvZG9zKSlcbiAgaWYoY29tcGxldGVkLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSA9PT0gdHJ1ZSlcbiAgICBTaG93TGlzdFRhc2soXCJjb21wbGV0ZWRcIilcbiAgZWxzZSBpZihhY3RpdmUuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZlXCIpID09PSB0cnVlKSB7XG4gICAgU2hvd0xpc3RUYXNrKFwiYWN0aXZlXCIpXG4gIH0gZWxzZSB7XG4gICAgU2hvd0xpc3RUYXNrKFwiYWxsXCIpXG4gIH1cbiAgY291bnRUYXNrQWN0aXZlKClcbn1cblxuZnVuY3Rpb24gU2hvd0xpc3RUYXNrKGV2ZW50OiBzdHJpbmcpIHtcbiAgbGV0IGh0bWw6IHN0cmluZyA9IFwiXCI7XG4gIGlmICh0b2Rvcykge1xuICAgIHRvZG9zLmZvckVhY2goKGRhdGEsIGlkKSA9PiB7XG4gICAgICBsZXQgaXNjaGVjazogc3RyaW5nID0gZGF0YS5jb21wbGV0ZVxuICAgICAgaWYgKGlzY2hlY2sgPT09IFwiY29tcGxldGVkXCIpIHtcbiAgICAgICAgICBpc2NoZWNrID0gXCJjaGVja2VkXCJcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXNjaGVjayA9IFwiXCJcbiAgICAgIH1cbiAgICAgIGlmIChldmVudCA9PT0gZGF0YS5jb21wbGV0ZSB8fCBldmVudCA9PT0gXCJhbGxcIikge1xuICAgICAgaHRtbCArPSBgXG4gICAgICA8ZGl2IGNsYXNzPVwidG8tZG9cIj5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgY2xhc3M9XCJ0ZXh0ICR7aXNjaGVja31cIiBpZCA9IFwiJHtpZH1cIiB2YWx1ZSA9IFwiJHtkYXRhLnRhc2t9XCIgb25kYmxjbGljayA9IFwiZWRpdFRhc2sodGhpcylcIiByZWFkb25seT5cbiAgICAgICAgPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNsYXNzPVwiY2hlY2tib3hcIiBpZCA9IFwiJHtpZH1cIiBvbmNsaWNrID0gXCJDaGVja0NvbXBsZXRlKHRoaXMpXCIgJHtpc2NoZWNrfT5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImRlbGV0ZVwiIGlkPVwiJHtpZH1cIiBvbmNsaWNrID0gXCJEZWxldGVUYXNrKCR7aWR9KVwiPjxpIGNsYXNzPVwiZmEtc29saWQgZmEteG1hcmtcIj48L2k+PC9idXR0b24+XG4gICAgICA8L2Rpdj5gXG4gICAgICB9XG4gICAgfSlcbiAgICBuZXdMaXN0LmlubmVySFRNTCA9IGh0bWw7XG4gICAgY291bnRUYXNrQWN0aXZlKClcbiAgfVxufVxuU2hvd0xpc3RUYXNrKFwiYWxsXCIpXG5cbm5ld1Rhc2suYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICBsZXQgaW5wdXRWYWx1ZTogc3RyaW5nID0gbmV3VGFzay52YWx1ZS50cmltKCk7XG4gIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmIGlucHV0VmFsdWUgPT0gXCJcIikge1xuICAgIGFsZXJ0KFwicGxlYXNlIGZpbGwgaW4gdGFzayBpbnB1dFwiKTtcbiAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09IFwiRW50ZXJcIiAmJiBpbnB1dFZhbHVlICE9PSBcIlwiKSB7XG4gICAgaWYgKCF0b2Rvcykge1xuICAgICAgICB0b2RvcyA9IFtdO1xuICAgIH1cbiAgICAgbGV0IG9iajogTGlzdFRvZG8gPSB7XG4gICAgICAgIHRhc2s6aW5wdXRWYWx1ZSxcbiAgICAgICAgY29tcGxldGU6IFwiYWN0aXZlXCJcbiAgICB9XG4gICAgdG9kb3MucHVzaChvYmopXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJsaXN0VG9kb1wiLCBKU09OLnN0cmluZ2lmeSh0b2RvcykpO1xuICAgIG5ld1Rhc2sudmFsdWUgPSBcIlwiO1xuICAgIFNob3dMaXN0VGFzayhcImFsbFwiKVxuICAgIGNvdW50VGFza0FjdGl2ZSgpXG4gIH1cbn0pXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=